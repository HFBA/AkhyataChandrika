# Refresh and Redistribute Script

## Overview

The `refreshAndRedistribute.py` script automates the process of:
1. **Refreshing** collector output files with current item counts
2. **Redistributing** the updated data into **existing** part files while preserving resolved status and comments

## Location

```
Scripts/AI_Generated/scripts/refreshAndRedistribute.py
```

## Usage

### Basic Usage

```bash
python3 Scripts/AI_Generated/scripts/refreshAndRedistribute.py \
    Scripts/output/AkhyataChandrika_Autogenerated.json \
    Scripts/AI_Generated/output
```

### Skip Refresh (Only Redistribute)

```bash
python3 Scripts/AI_Generated/scripts/refreshAndRedistribute.py \
    Scripts/output/AkhyataChandrika_Autogenerated.json \
    Scripts/AI_Generated/output \
    --skip-refresh
```

## What It Does

### Step 1: Refresh Collector Files

Runs both collector scripts:
- `collectMultipleDhatuIds.py` - Collects verbs with multiple dhatu_ids
- `collectNotFoundDhatuIds.py` - Collects verbs with "Not Found" dhatu_ids

### Step 2: Redistribute into Existing Folders

Detects existing folders and redistributes updated data into existing part files.

## Key Features

- **Preserves Manual Edits**: Maintains `resolved` and `comment` fields
- **Auto-Detects Parts**: Automatically detects number of existing part files
- **Equal Distribution**: Distributes items equally across all parts

## Example Output

```
multipleDhatuIdsWithoutGati (187 items across 10 parts):
  - Parts 1-9: 19 items each
  - Part 10: 16 items

multipleDhatuIdsWithGati (101 items across 10 parts):
  - Parts 1-9: 11 items each
  - Part 10: 2 items

notFoundDhatuIdsWithoutGati (465 items across 10 parts):
  - Parts 1-9: 47 items each
  - Part 10: 42 items
```

## Handling Resolved Items

### Important Behavior

When you mark an item as `resolved: "true"`:
1. The **backport script** removes it from the source YAML files
2. The **refresh script** will NOT re-add it when refreshing

This means once an item is marked as resolved:
- It's permanently removed from the workflow
- Future refreshes will skip it
- Workers won't see it again in their part files

### Progress Tracking

The script shows progress:
```
‚úì Found 1 resolved items (will be skipped)
‚è≠Ô∏è  Skipped 1 already-resolved items
üìä Total items to redistribute: 100  (was 101)
```

This helps you track how much work has been completed!

## Notes

- Never creates new folders - only refreshes existing ones
- Preserves manual edits (resolved status and comments)
- Skips items marked as resolved (won't re-add them)
- Can be run multiple times safely
